<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Graph Visualization with Cytoscape.js</title>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.30.0/cytoscape.min.js"></script> -->
    <script src="cytoscape_3.30.0.min.js"></script>
    <style>
        #cy {
            width: 100%;
            height: 600px;
            display: block;
        }
    </style>
</head>
<body>
<div id="cy"></div>

<script>
    fetch('/spring-neptune-demo/graph/data')
        .then(response => response.json())
        .then(data => {
            console.log('Fetched Data:', data);

            // Extract vertices
            const vertices = Object.keys(data.vertices).map(vertexId => ({
                data: {
                    id: vertexId,
                    label: data.vertices[vertexId].label,
                    name: data.vertices[vertexId].name
                }
            }));

            // Extract edges
            const edges = Object.keys(data.edges).map(edgeId => ({
                data: {
                    id: edgeId,
                    source: data.edges[edgeId].source,
                    target: data.edges[edgeId].target,
                    label: data.edges[edgeId].label
                }
            }));

            console.log('Vertices:', vertices);
            console.log('Edges:', edges);

            // Initialize Cytoscape
            const cy = cytoscape({
                container: document.getElementById('cy'),
                elements: {
                    nodes: vertices,
                    edges: edges
                },
                style: [
                    {
                        selector: 'node',
                        style: {
                            'background-color': '#1f77b4',
                            'label': 'data(name)'
                        }
                    },
                    {
                        selector: 'edge',
                        style: {
                            'curve-style': 'bezier',
                            'target-arrow-shape': 'triangle',
                            'target-arrow-color': '#ccc',
                            'line-color': '#999',
                            'width': 2,
                            'label': 'data(label)',
                            'text-background-color': '#fff',
                            'text-background-opacity': 1,
                            'text-background-padding': '3px'
                        }
                    }
                ],
                layout: {
                    name: 'grid',
                    rows: 1
                }
            });

            // Optional: Fit the graph to the viewport
            cy.fit();
        })
        .catch(error => console.error('Error fetching data:', error));
</script>
</body>
</html>